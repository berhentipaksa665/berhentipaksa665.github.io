<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daftar Halaman</title>
<style>
  body { font-family: system-ui, sans-serif; margin: 2rem; background: #fafafa; color: #333; }
  h2 { font-size: 1.4rem; margin-bottom: 1rem; }
  ul { list-style: none; padding: 0; }
  li { margin: 0.4rem 0; }
  a { color: #0366d6; text-decoration: none; }
  a:hover { text-decoration: underline; }
  .loading { color: #888; font-style: italic; }
</style>
</head>
<body>
  <h2>Daftar Semua Halaman di Situs Ini</h2>
  <p class="loading">Memuat daftar halaman...</p>
  <ul id="sitemap-list"></ul>

  <script>
  async function loadSitemap() {
    const list = document.getElementById('sitemap-list');
    const loadingText = document.querySelector('.loading');
    try {
      // ambil sitemap.xml dari domain saat ini
      const sitemapUrl = `${location.origin}/sitemap.xml`;
      const res = await fetch(sitemapUrl);
      if (!res.ok) throw new Error('Gagal memuat sitemap.xml');

      const xmlText = await res.text();
      const parser = new DOMParser();
      const xmlDoc = parser.parseFromString(xmlText, "application/xml");
      const urls = xmlDoc.querySelectorAll("url > loc");

      // hapus teks loading
      loadingText.remove();

      if (urls.length === 0) {
        list.innerHTML = '<li>Tidak ada URL ditemukan di sitemap.xml</li>';
        return;
      }

      urls.forEach(u => {
        const url = u.textContent.trim();
        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = url;
        a.textContent = url.replace(/^https?:\/\//, ''); // tampil tanpa protokol
        li.appendChild(a);
        list.appendChild(li);
      });

    } catch (err) {
      loadingText.textContent = 'Gagal memuat sitemap.';
      console.error(err);
    }
  }

  loadSitemap();
  </script>
</body>
</html>
