<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Daftar Halaman Situs</title>
<style>
  body { font-family: system-ui, sans-serif; margin: 2rem; background: #fafafa; color: #222; }
  h2 { font-size: 1.4rem; margin-bottom: 1rem; }
  ul { list-style: none; padding: 0; }
  li { margin: 0.4rem 0; }
  a { color: #0070f3; text-decoration: none; }
  a:hover { text-decoration: underline; }
  .loading { color: #777; font-style: italic; }
</style>
</head>
<body>
  <h2>Daftar Halaman di Situs Ini</h2>
  <p class="loading">Memuat daftar halaman...</p>
  <ul id="sitemap-list"></ul>

  <script>
  async function loadSitemap() {
    const list = document.getElementById('sitemap-list');
    const loading = document.querySelector('.loading');

    try {
      const sitemapURL = `${location.origin}/sitemap.xml`;
      const res = await fetch(sitemapURL);
      if (!res.ok) throw new Error("Gagal mengambil sitemap.xml");

      const xmlText = await res.text();
      const parser = new DOMParser();
      const xml = parser.parseFromString(xmlText, "application/xml");

      const urls = xml.querySelectorAll("url > loc");
      loading.remove();

      if (!urls.length) {
        list.innerHTML = "<li>Tidak ada URL ditemukan.</li>";
        return;
      }

      urls.forEach(node => {
        let path = node.textContent.trim();

        // Hanya ambil path (tanpa domain)
        path = path.replace(/^https?:\/\/[^/]+/i, '');

        // Hilangkan trailing slash pada root (kecuali "/")
        if (path.endsWith('/') && path !== '/') path = path.slice(0, -1);

        // Ambil teks tanpa ekstensi .html
        const text = path.replace(/^\/|\.html$/g, '');

        const li = document.createElement('li');
        const a = document.createElement('a');
        a.href = path;
        a.textContent = text || 'Halaman utama';
        li.appendChild(a);
        list.appendChild(li);
      });

    } catch (e) {
      loading.textContent = "Gagal memuat sitemap.";
      console.error(e);
    }
  }

  loadSitemap();
  </script>
</body>
</html>
