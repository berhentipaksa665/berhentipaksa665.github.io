<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dynamic Domain Index</title>
<style>
  html,body {margin:0;padding:0;height:100%;width:100%;}
  iframe {border:0;width:100%;height:100%;}
</style>
</head>
<body>
<script>
(async () => {
  const host = location.hostname; // contoh: www.domain.my.id
  const parts = host.split(".");

  let filePath = "";
  // === Aturan utama ===
  if (host.startsWith("www.")) {
    // contoh: www.domain.my.id --> www.domain.html
    const domain = parts.slice(-3).join("."); // domain.my.id
    filePath = `/index/www.${domain.split(".")[0]}.html`;
  } else if (parts.length >= 3) {
    // contoh: sub.domain.my.id --> sub.domain.html
    const sub = parts[0];
    const domain = parts.slice(-3).join(".");
    filePath = `/index/${sub}.${domain.split(".")[0]}.html`;
  } else {
    // contoh: domain.my.id atau domain.com --> domain.html
    const domain = parts[0];
    filePath = `/index/${domain}.html`;
  }

  try {
    const res = await fetch(filePath);
    if (res.ok) {
      const html = await res.text();
      document.open();
      document.write(html);
      document.close();
    } else {
      // fallback jika tidak ada file
      const fallback = await fetch("/index/fallback.index.html");
      if (fallback.ok) {
        const html = await fallback.text();
        document.open();
        document.write(html);
        document.close();
      }
    }
  } catch (e) {
    const fallback = await fetch("/index/fallback.index.html");
    if (fallback.ok) {
      const html = await fallback.text();
      document.open();
      document.write(html);
      document.close();
    }
  }
})();
</script>
</body>
</html>
