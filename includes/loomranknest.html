<link rel="stylesheet" href="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.css">

<style>
.video-container {
  position: relative;
  width: 100%;
  max-width: 900px;
  margin: 1em auto;
  padding-top: 56.25%; /* 16:9 */
  background: #000;
  border-radius: 8px;
  overflow: hidden;
}
.video-container video {
  position: absolute;
  top: 0; left: 0;
  width: 100%; height: 100%;
  object-fit: cover;
}
.video-poster {
  position: absolute;
  inset: 0;
  background-size: cover;
  background-position: center;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}
.video-poster span {
  background: rgba(0,0,0,0.6);
  color: #fff;
  border-radius: 50%;
  width: 68px;
  height: 68px;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size: 30px;
}
.video-container.initialized .video-poster {
  display: none;
}
</style>

<div class="video-container" id="fp1"
     data-video="/video/leaked-01.mp4"
     data-poster="/photo/fallback-01.png">
  <video id="video1" preload="none" playsinline controls poster="/photo/fallback-01.png"></video>
  <div class="video-poster" style="background-image:url('/photo/fallback-01.png')">
    <span>â–¶</span>
  </div>
</div>

<noscript>
  <video controls poster="/photo/fallback-01.png" width="100%">
    <source src="/video/leaked-01.mp4" type="video/mp4">
    Browser Anda tidak mendukung video. <a href="/video/leaked-01.mp4">Download</a>
  </video>
</noscript>

<script>
(function(){
  const wrapper = document.getElementById('fp1');
  const video = document.getElementById('video1');
  const poster = wrapper.querySelector('.video-poster');
  const src = wrapper.dataset.video;

  function loadScript(src){
    return new Promise((res,rej)=>{
      if(document.querySelector('script[src="'+src+'"]')) return res();
      const s=document.createElement('script');
      s.src=src; s.async=true;
      s.onload=res; s.onerror=rej;
      document.body.appendChild(s);
    });
  }

  async function initPlayer(){
    if(wrapper.classList.contains('initialized')) return;
    const source = document.createElement('source');
    source.src = src;
    source.type = 'video/mp4';
    video.appendChild(source);
    await loadScript('https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js');
    fluidPlayer('video1',{ layoutControls:{ fillToContainer:true, posterImage:wrapper.dataset.poster } });
    wrapper.classList.add('initialized');
  }

  poster.addEventListener('click', ()=>{
    initPlayer().then(()=>video.play());
  });

  if('IntersectionObserver' in window){
    const io=new IntersectionObserver((entries,obs)=>{
      entries.forEach(e=>{
        if(e.isIntersecting){ initPlayer(); obs.unobserve(wrapper); }
      });
    },{rootMargin:"200px"});
    io.observe(wrapper);
  } else {
    setTimeout(initPlayer,1500);
  }
})();
</script>
